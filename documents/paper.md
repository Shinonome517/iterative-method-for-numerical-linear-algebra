---
marp: true
theme: gaia
---
<!-- paginate: true -->
<!-- footer: RICORA PROGRAMMING TEAM -->

# 第9回数値解析班輪講

連立一次方程式の解法2 ~疎行列と反復法~

---

## 輪講の目的

### 目的二つ

1. 数値計算について学ぶ
2. Pythonの使用経験を積む

### やっていること

1. 定理の証明・アルゴリズムの勉強（数学）
2. 実装（プログラミング）

---

## 数値計算とは

*連続数学への離散的アプローチ*

微分方程式の数値解法

* Eular法
* Runge-Kutta法

![bg right:45%](./pictures/eular-runge.png)


---

## 本日のお品書き

### データ構造

* 疎行列とは
* 疎行列のデータ構造

### 反復法（アルゴリズム）

* 反復法とは
* ヤコビ法
* 共役勾配法



---

## 本題

![bg right:70%](./pictures/kusatsu.JPG)

---

## 疎行列とは


![bg 80%](pictures/mumplus.png)
![bg 80%](pictures/matrix1.png)

---

## 疎行列のデータ形式

通常の二次元配列だと無駄が多い

↓

データを圧縮した形で保存する

---

## 疎行列のデータ形式

次の行列を疎行列特有の形式で保存する

$$

A = 
\begin{pmatrix}
1 & 0 & 2 & 0 & 0 \\
0 & 3 & 0 & 0 & -4 \\
0 & 0 & 5 & 0 & 0 \\
6 & 0 & 0 & -7 & 0 \\
0 & 0 & 0 & 0 & 8
\end{pmatrix}

$$

---

## 疎行列のデータ構造

### COO方式(sparse matrix in **COO**rdinate format)

データ、行番号、列番号、をそれぞれリストで保管

```Python
data[] = [1, 2, 3, -4, 5, 6, -7, 8]
row[] = [0, 0, 1, 1, 2, 3, 3, 4]
col[] = [0, 2, 1, 4, 2, 0, 3, 4]
```

ex) $a_{25} = -4$ 

---

## 疎行列のデータ構造

### CSR方式(**C**ompressed **S**parse **R**ow Matrix)

データ、列番号、行が切り替わるデータの場所、をそれぞれリストで保管

```Python
data[] = [1, 2, 3, -4, 5, 6, -7, 8]
indices[] = [0, 2, 1, 4, 2, 0, 3, 4]
indptr[] = [0, 2, 4, 5, 7, 8]
```

data[] = [|1, 2, |3, -4, |5, |6, -7, |8]

---

## 疎行列のデータ構造

### CSC方式(**C**ompressed **S**parse **C**olumn Matrix)

データ、行番号、列が切り替わるデータの場所、をそれぞれリストで保管

```Python
data[] = [1, 6, 3, 2, 5, -7, -4, 8]
indices[] = [0, 3, 1, 0, 2, 3, 1, 4]
indptr[] =  [0, 2, 3, 5, 6, 8]
```

data[] = [|1, 6, |3, |2, 5, |-7, |-4, 8]

---

## 疎行列のデータ構造

### 実装


---
---

## 参考資料

https://hamukazu.com/2014/12/03/internal-data-structure-scipy-sparse/

---